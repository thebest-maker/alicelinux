<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="icon" type="image/x-icon" href="/img/favicon.ico">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="apple-mobile-web-app-title" content="AliceLinux">
  <meta name="application-name" content="AliceLinux">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="theme-color" content="#ffffff">

  <style>
    body{font-family:monospace;}
    html{cursor: url('https://alicelinux.xplshn.com.ar/img/9cursor.png'), auto;}
  </style>

  <title>packagemanager.md</title>
  
  
  <link rel="stylesheet" href="https://alicelinux.xplshn.com.ar/css/style.css">
  
  <link rel="stylesheet" href="https://alicelinux.xplshn.com.ar/css/theme_purple.css">

  

  
  <link href='https://alicelinux.xplshn.com.ar/css/SerenityOS-Emoji.css' rel="stylesheet" type="text/css">
  <link href='https://alicelinux.xplshn.com.ar/css/highlightjs_style.css' rel="stylesheet" type="text/css">
  
  
  
  <script src="https://alicelinux.xplshn.com.ar/js/tex-mml-svg.js"></script>
  <script src="https://alicelinux.xplshn.com.ar/js/highlight.min.js"></script>
  <script src="https://alicelinux.xplshn.com.ar/js/highlight-basic.min.js"></script>
  <script src="https://alicelinux.xplshn.com.ar/js/highlight-bash.min.js"></script>
  <script src="https://alicelinux.xplshn.com.ar/js/highlight-go.min.js"></script>
  <script src="https://alicelinux.xplshn.com.ar/js/highlight-c.min.js"></script>
  
  <script>
  (function() {
    function center_el(tagName) {
      var tags = document.getElementsByTagName(tagName), i, tag;
      for (i = 0; i < tags.length; i++) {
        tag = tags[i];
        var parent = tag.parentElement;
        
        if (parent.childNodes.length === 1) {
          
          if (parent.nodeName === 'A') {
            parent = parent.parentElement;
            if (parent.childNodes.length != 1) continue;
          }
          if (parent.nodeName === 'P') parent.style.textAlign = 'center';
        }
      }
    }
    var tagNames = ['img', 'embed', 'object'];
    for (var i = 0; i < tagNames.length; i++) {
      center_el(tagNames[i]);
    }
  })();
  </script>
</head>
<body>
  <header>
    <nav class="no-print">
    
    <div class="left">
      
    </div>
    <div class="right">
      <span class="doNotDisplay">Related sites:</span>
      |
      
        <a href="https://musl.libc.org">musl.libc.org</a> |
      
        <a href="https://web.archive.org/web/20231123031907/https://managainstthestate.blogspot.com/2011/08/anarcho-capitalist-resources-by-wesker.html">managainstthestate.blogspot.com</a> |
      
        <a href="https://shithub.us">shithub.us</a> |
      
        <a href="https://copacabana.pindorama.net.br">copacabana.pindorama.net.br</a> |
      
        <a href="https://suckless.org">suckless.org</a> |
      
        <a href="https://nosystemd.org">nosystemd.org</a> |
      
        <a href="https://harmful.cat-v.org">harmful.cat-v.org</a> |
      
        <a href="https://github.com/xplshn/dbin">dbin</a> |
      
        <a href="https://fatbuffalo.neocities.org/def">neoblog</a> |
      
        <a href="/index.xml">subscribe</a> |
      
    </div>
  </nav>
  <h1>
    <a href="https://alicelinux.xplshn.com.ar/">AliceLinux
      <span id="headerSubTitle">AliceLinux&#39;s (un)official documentation and devblog</span>
    </a>
  </h1>
</header>

  
<nav id="side-bar">

  <div>
    <ul>
    
    
      
        <li><a href="/" title="">&rsaquo; Home</a></li>
      
    
    
    
      
        <li><a href="https://alicelinux.xplshn.com.ar/docs/" title="Docs">&rsaquo; Docs</a></li>
      
    
    </ul>
  </div>
</nav>

  <article id="main">
    
  <div class="article-meta">
    <h1><span class="title">packagemanager.md</span></h1>
    
        <span class="author">
    <span class="author">
      by
      <a href="mailto:emmett1.2miligrams@protonmail.com">
        emmett1
      </a>
    </span>

</span>
        
            &ndash; <span class="date">2025/04/10</span>
        
    
    <p class="terms">
      
        
      
        
      
    </p>
  </div>
  
  <main>
    <h1 id="package-manager">Package Manager</h1>
<p>In Alice, there are two package managers used: <a href="https://codeberg.org/emmett1/spm">spm</a> and <a href="https://codeberg.org/emmett1/autils">autils</a>. Why two package managers? <code>spm</code> was written as a generic package manager for Linux distributions. <code>autils</code> is written specifically for <code>Alice</code> and requires <code>spm</code>.</p>
<h2 id="spm">spm</h2>
<p><code>spm</code> stands for <code>simple package manager</code>. It is simple and minimal, written in POSIX-compliant shell script. It only depends on core utils and tar (or busybox&rsquo;s utils and tar). <code>spm</code> is intended for compressing a directory into a package and then extracting the package into the system with files being tracked into a database. There is no build script, recipe, or ports in <code>spm</code>. You can write your own tools to use with <code>spm</code>, similar to Arch Linux&rsquo;s <code>makepkg</code>, CRUX&rsquo;s <code>pkgmk</code>, or Slackware&rsquo;s <code>slackbuild</code> script.</p>
<h3 id="spm---usage">spm - usage</h3>
<p>List <code>spm</code> usage:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>-a         print all installed packages
</span></span><span style="display:flex;"><span>-b &lt;path&gt;  build &lt;path&gt; directory into package
</span></span><span style="display:flex;"><span>-h         print this help message
</span></span><span style="display:flex;"><span>-i &lt;file&gt;  install &lt;file&gt; package into system
</span></span><span style="display:flex;"><span>-l &lt;pkg&gt;   list files installed by &lt;pkg&gt;
</span></span><span style="display:flex;"><span>-o &lt;file&gt;  print owner of &lt;file&gt;
</span></span><span style="display:flex;"><span>-r &lt;name&gt;  remove installed &lt;name&gt; from system
</span></span><span style="display:flex;"><span>-u &lt;pkg&gt;   re-install/upgrade &lt;pkg&gt;
</span></span></code></pre></div><p>List all installed packages with version:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ spm -a
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>neofetch 7.1.0-1
</span></span><span style="display:flex;"><span>nettle 3.10-1
</span></span><span style="display:flex;"><span>nghttp2 1.62.1-1
</span></span><span style="display:flex;"><span>ninja 1.12.1-1
</span></span><span style="display:flex;"><span>nodejs 22.5.1-1
</span></span><span style="display:flex;"><span>nspr 4.35-1
</span></span><span style="display:flex;"><span>nss 3.102.1-1
</span></span><span style="display:flex;"><span>nsxiv 32-1
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>Build package from directory:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># (build package)</span>
</span></span><span style="display:flex;"><span>$ ./configure --prefix<span style="color:#f92672">=</span>/usr
</span></span><span style="display:flex;"><span>$ make
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># (install into fake directory)</span>
</span></span><span style="display:flex;"><span>$ make DESTDIR<span style="color:#f92672">=</span>$PWD/fakeroot install
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># (turn fake directory into package (package.spm))</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># spm -b $PWD/fakeroot</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># (mv &#39;package.spm&#39; into correct format (name#version-release.spm))</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># mv package.spm pkgname#pkgversion-pkgrelease.spm</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># (install package into system)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># spm -i pkgname#pkgversion-pkgrelease.spm</span>
</span></span></code></pre></div><p>Install package into system:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># spm -i pkgname#pkgversion-pkgrelease.spm</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>pkgname<span style="color:#f92672">]</span> Verify package...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>pkgname<span style="color:#f92672">]</span> Checking <span style="color:#66d9ef">for</span> conflicts...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>pkgname<span style="color:#f92672">]</span> Installing package...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>pkgname<span style="color:#f92672">]</span> Package <span style="color:#e6db74">&#39;pkgname#pkgversion-pkgrelease&#39;</span> installed.
</span></span></code></pre></div><p>List files installed by &lsquo;packagename&rsquo;:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ spm -l test
</span></span><span style="display:flex;"><span>usr/
</span></span><span style="display:flex;"><span>usr/share/
</span></span><span style="display:flex;"><span>usr/share/aaa
</span></span><span style="display:flex;"><span>usr/bin/
</span></span><span style="display:flex;"><span>usr/bin/aaa
</span></span></code></pre></div><p>List package owner of a file (can use regex):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ spm -o gcc$
</span></span><span style="display:flex;"><span>ccache usr/lib/ccache/gcc
</span></span><span style="display:flex;"><span>gcc usr/bin/gcc
</span></span><span style="display:flex;"><span>gcc usr/bin/x86_64-pc-linux-musl-gcc
</span></span><span style="display:flex;"><span>linux lib/modules/6.6.41-Alice/build/scripts/dummy-tools/gcc
</span></span></code></pre></div><p>Upgrade/reinstall installed package:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># spm -u pkgname#pkgversion-pkgrelease.spm</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>pkgname<span style="color:#f92672">]</span> Verify package...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>pkgname<span style="color:#f92672">]</span> Checking <span style="color:#66d9ef">for</span> conflicts...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>pkgname<span style="color:#f92672">]</span> Upgrading package...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>pkgname<span style="color:#f92672">]</span> Package <span style="color:#e6db74">&#39;pkgname#pkgversion-pkgrelease&#39;</span> upgraded.
</span></span></code></pre></div><h3 id="spm---environment">spm - environment</h3>
<table>
  <thead>
      <tr>
          <th>env</th>
          <th>description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>SPM_ROOT</td>
          <td>use custom root location for package installation</td>
      </tr>
      <tr>
          <td>SPM_FORCEINSTALL</td>
          <td>set any value to ignore conflicted files</td>
      </tr>
  </tbody>
</table>
<p>You can pass these environment variables to the <code>spm</code> command, for example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># SPM_ROOT=/mnt/rootfs spm -i pkgname#pkgversion-pkgrelease.spm</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># SPM_FORCEINSTALL=1 SPM_ROOT=/mnt/rootfs spm -i pkgname#pkgversion-pkgrelease.spm</span>
</span></span></code></pre></div><h2 id="autils">autils</h2>
<p><code>autils</code> stands for <code>alice utilities</code>. <code>autils</code> contains the main package manager (apkg), utilities (apkg-<util>), and various utility scripts. <code>autils</code> is specifically written to manage <code>Alice</code> packages.</p>
<h3 id="apkg">apkg</h3>
<p><code>apkg</code> is the main package manager that can solve dependencies, batch install/upgrade/remove packages, perform system upgrades, trigger necessary caches, and more. <code>apkg</code> can be run inside or outside a package template.</p>
<p>When running outside a package template, <code>apkg</code> will need &lsquo;package names&rsquo; as arguments, and those &lsquo;package names&rsquo; will be searched through the <code>APKG_REPO</code> environment variable. Example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># apkg testpkg testpkg2 (build testpkg and testpkg2)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># apkg testpkg testpkg2 -i (build and install testpkg and testpkg2)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># apkg -u testpkg testpkg2 (upgrade/reinstall testpkg and testpkg2)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># apkg -f -u testpkg testpkg2 (force rebuild then upgrade/reinstall testpkg and testpkg2)</span>
</span></span></code></pre></div><p>When running inside a package template, <code>apkg</code> will perform the operation for the current directory&rsquo;s package. Example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># cd /path/to/local/testpkg</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># apkg (build testpkg)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># apkg -i (build and install testpkg)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># apkg -u (upgrade/reinstall testpkg)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># apkg -u -f (force rebuild then upgrade/reinstall testpkg)</span>
</span></span></code></pre></div><h3 id="apkg---usage">apkg - usage</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>-i &lt;pkg<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>&gt;  install package<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>-I &lt;pkg<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>&gt;  install packages<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span> with dependencies
</span></span><span style="display:flex;"><span>-d &lt;pkg&gt;     list &lt;pkg&gt; dependencies
</span></span><span style="display:flex;"><span>-D &lt;pkg<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>&gt;  list all dependencies
</span></span><span style="display:flex;"><span>-j &lt;pkg&gt;     list all dependents
</span></span><span style="display:flex;"><span>-u &lt;pkg<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>&gt;  upgrade package<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>-t <span style="color:#f92672">[</span>pkg<span style="color:#f92672">(</span>s<span style="color:#f92672">)]</span>  trigger system cache/db updates
</span></span><span style="display:flex;"><span>-U           update system
</span></span><span style="display:flex;"><span>-f           force rebuild
</span></span><span style="display:flex;"><span>-o &lt;pkg<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>&gt;  download source
</span></span><span style="display:flex;"><span>-p &lt;pkg&gt;     print package path
</span></span><span style="display:flex;"><span>-s &lt;pattern&gt; search packages
</span></span><span style="display:flex;"><span>-h           print this help message
</span></span></code></pre></div><p>I won&rsquo;t explain the details of every option here, but I will give some quick tips/tricks to use <code>apkg</code>.</p>
<p>Install a package and its dependencies (mind the uppercase <code>I</code>):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># apkg -I sway</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Solving dependencies...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Installing <span style="color:#ae81ff">3</span> package<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>:  mesa pango sway
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Press ENTER to <span style="color:#66d9ef">continue</span> operation.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Press Ctrl + C to abort.
</span></span></code></pre></div><p>Search available packages:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ apkg -s sway
</span></span><span style="display:flex;"><span>swaybg
</span></span><span style="display:flex;"><span>swaylock
</span></span><span style="display:flex;"><span>sway
</span></span><span style="display:flex;"><span>swayidle
</span></span><span style="display:flex;"><span>swayfx
</span></span></code></pre></div><p>Install all packages with &lsquo;sway&rsquo; in their name and their dependencies:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># apkg -I $(apkg -s sway)</span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Package <span style="color:#e6db74">&#39;mesa&#39;</span> is installed
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Package <span style="color:#e6db74">&#39;swaybg&#39;</span> is installed
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Package <span style="color:#e6db74">&#39;swaylock&#39;</span> is installed
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Package <span style="color:#e6db74">&#39;swayidle&#39;</span> is installed
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Package <span style="color:#e6db74">&#39;swayfx&#39;</span> is installed
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Solving dependencies...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Installing <span style="color:#ae81ff">2</span> package<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>:  pango sway
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Press ENTER to <span style="color:#66d9ef">continue</span> operation.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Press Ctrl + C to abort.
</span></span></code></pre></div><p>Install a package without solving dependencies (mind the lowercase <code>i</code> and there is no prompt for this option):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># apkg -i wlroots mesa</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Package <span style="color:#e6db74">&#39;wlroots&#39;</span> already installed.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Package <span style="color:#e6db74">&#39;mesa&#39;</span> already installed.
</span></span></code></pre></div><p>List all installed packages:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ apkg -a
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>qemu
</span></span><span style="display:flex;"><span>ranger
</span></span><span style="display:flex;"><span>rdfind
</span></span><span style="display:flex;"><span>readline
</span></span><span style="display:flex;"><span>rsync
</span></span><span style="display:flex;"><span>rtorrent
</span></span><span style="display:flex;"><span>rust
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>List all installed packages with a filter (will only print installed packages containing the word filter):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ apkg -a sway
</span></span><span style="display:flex;"><span>swaybg
</span></span><span style="display:flex;"><span>swayfx
</span></span><span style="display:flex;"><span>swayidle
</span></span><span style="display:flex;"><span>swaylock
</span></span></code></pre></div><p>List dependencies of a package:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ apkg -d sway
</span></span><span style="display:flex;"><span>wlroots
</span></span><span style="display:flex;"><span>json-c
</span></span><span style="display:flex;"><span>pango
</span></span></code></pre></div><p>List all dependencies tree of package(s):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ apkg -D sway dwm
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>wayland
</span></span><span style="display:flex;"><span>wayland-protocols
</span></span><span style="display:flex;"><span>xkeyboard-config
</span></span><span style="display:flex;"><span>xcb-proto
</span></span><span style="display:flex;"><span>xorgproto
</span></span><span style="display:flex;"><span>util-macros
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>Upgrade/reinstall package(s):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># apkg -u wlroots cwm pango</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>wlroots<span style="color:#f92672">]</span> Verify package...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>wlroots<span style="color:#f92672">]</span> Checking <span style="color:#66d9ef">for</span> conflicts...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>wlroots<span style="color:#f92672">]</span> Upgrading package...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>wlroots<span style="color:#f92672">]</span> Package <span style="color:#e6db74">&#39;wlroots#0.17.4-1&#39;</span> upgraded.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>cwm<span style="color:#f92672">]</span> Verify package...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>cwm<span style="color:#f92672">]</span> Checking <span style="color:#66d9ef">for</span> conflicts...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>cwm<span style="color:#f92672">]</span> Upgrading package...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>cwm<span style="color:#f92672">]</span> Package <span style="color:#e6db74">&#39;cwm#7.4-1&#39;</span> upgraded.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>pango<span style="color:#f92672">]</span> Verify package...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>pango<span style="color:#f92672">]</span> Checking <span style="color:#66d9ef">for</span> conflicts...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>pango<span style="color:#f92672">]</span> Upgrading package...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>pango<span style="color:#f92672">]</span> Package <span style="color:#e6db74">&#39;pango#1.54.0-1&#39;</span> upgraded.
</span></span></code></pre></div><p>Full system upgrade (mind uppercase <code>U</code> and will prompt first if there are package updates):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># apkg -U</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Checking <span style="color:#66d9ef">for</span> outdated packages...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Solving dependencies...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Upgrading <span style="color:#ae81ff">3</span> package<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>:  initscripts mesa sowm
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Press ENTER to <span style="color:#66d9ef">continue</span> operation.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Press Ctrl + C to abort.
</span></span></code></pre></div><p>Make a full system rebuild in dependencies order (<code>-f</code>: force rebuild, <code>-u</code>: upgrade/reinstall, <code>-D</code>: solve dependency order, <code>-a</code>: list all installed package(s)):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># apkg -f -u $(apkg -D $(apkg -a))</span>
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>start rebuilding packages in dependencies order here<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>Remove installed packages:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># apkg -r wlroots pango sway</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Package <span style="color:#e6db74">&#39;wlroots&#39;</span> removed.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Package <span style="color:#e6db74">&#39;pango&#39;</span> removed.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span> Package <span style="color:#e6db74">&#39;sway&#39;</span> removed.
</span></span></code></pre></div><p>Print package path:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ apkg -p sway
</span></span><span style="display:flex;"><span>/home/emmett/codeberg/alicelinux/repos/wayland/sway
</span></span></code></pre></div><h3 id="apkg---environment">apkg - environment</h3>
<p>You can pass environment variables to <code>apkg</code> to override defaults and in <code>/etc/apkg.conf</code>. Available environment variables and their default values are as follows:</p>
<table>
  <thead>
      <tr>
          <th>env</th>
          <th>default value</th>
          <th>description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>APKG_ROOT</td>
          <td>/</td>
          <td>root for package installation</td>
      </tr>
      <tr>
          <td>APKG_CONF</td>
          <td>/etc/apkg.conf</td>
          <td>apkg&rsquo;s config file</td>
      </tr>
      <tr>
          <td>APKG_REPO</td>
          <td></td>
          <td>defaults is empty, template repo path, space separated variable</td>
      </tr>
      <tr>
          <td>APKG_PACKAGE_DIR</td>
          <td>$PWD</td>
          <td>prebuilt package directory path</td>
      </tr>
      <tr>
          <td>APKG_SOURCE_DIR</td>
          <td>$PWD</td>
          <td>package source directory path</td>
      </tr>
      <tr>
          <td>APKG_WORK_DIR</td>
          <td>$PWD</td>
          <td>package working directory path</td>
      </tr>
      <tr>
          <td>APKG_NOPROMPT</td>
          <td></td>
          <td>skip prompt, use any value</td>
      </tr>
  </tbody>
</table>
<p>You can add these environment variables into the <code>apkg</code> config file.</p>
<h3 id="etcapkgconf">/etc/apkg.conf</h3>
<p><code>apkg</code> can work without its config file by using all default values. The default config path for <code>apkg</code> is <code>/etc/apkg.conf</code>. You can override the config path by appending <code>APKG_CONF</code> to <code>apkg</code>, for example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># APKG_CONF=/etc/apkg-local.conf apkg &lt;args&gt;</span>
</span></span></code></pre></div><h3 id="revdep">revdep</h3>
<p><code>revdep</code> is a script to find broken packages. It is recommended to run it after packages are removed or upgraded.</p>
<p>Usage:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># (print out broken packages)</span>
</span></span><span style="display:flex;"><span>$ revdep
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># (verbosely print missing libraries)</span>
</span></span><span style="display:flex;"><span>$ revdep -v
</span></span></code></pre></div><p>You can combine it with <code>apkg</code> to rebuild broken packages, for example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># apkg -f -u $(revdep)</span>
</span></span></code></pre></div><blockquote>
<p>NOTE: <code>revdep</code> does not solve dependencies, so you might need to manually rebuild broken packages instead of combining it with <code>apkg</code>.</p></blockquote>
<h3 id="updateconf">updateconf</h3>
<p><code>updateconf</code> is a script to update configuration files inside the <code>/etc</code> directory. It is recommended to run it after package upgrades.</p>
<h3 id="apkg-chroot">apkg-chroot</h3>
<p>Script to enter the chroot environment of a custom root location.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># apkg-chroot &lt;customroot path&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># apkg-chroot &lt;customroot path&gt; &lt;command&gt;</span>
</span></span></code></pre></div><h3 id="apkg-clean">apkg-clean</h3>
<p>Print out old package and source caches.</p>
<p>Options:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>-s  print sources only
</span></span><span style="display:flex;"><span>-p  print packages only
</span></span></code></pre></div><p>Usage:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># (to remove old packages)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># apkg-clean -p | xargs rm</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># (to remove old sources)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># apkg-clean -s | xargs rm</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># (to remove both old packages and sources)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># apkg-clean | xargs rm</span>
</span></span></code></pre></div><h3 id="apkg-deps">apkg-deps</h3>
<p>Script to find runtime linked dependencies of an installed package. It is good for figuring out dependencies when writing a package template.</p>
<p>Usage:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ apkg-deps &lt;pkg&gt;
</span></span></code></pre></div><h3 id="apkg-foreign">apkg-foreign</h3>
<p>Script to list installed packages outside the package repo.</p>
<p>Usage:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># (print list of foreign packages)</span>
</span></span><span style="display:flex;"><span>$ apkg-foreign
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># (remove foreign packages)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># apkg -r $(apkg-foreign)</span>
</span></span></code></pre></div><h3 id="apkg-orphan">apkg-orphan</h3>
<p>Script to print a list of packages without parent dependencies.</p>
<p>Usage:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ apkg-orphan
</span></span></code></pre></div><h3 id="apkg-redundantdeps">apkg-redundantdeps</h3>
<p>Script to print a package&rsquo;s redundant dependencies. It is good to use when writing a package template for minimizing dependencies and speeding up <code>apkg</code> dependencies solving.</p>
<p>Usage:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span><span style="color:#75715e"># (print packages containing redundant dependencies)</span>
</span></span><span style="display:flex;"><span>$ apkg-redundantdeps
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># (remove redundant dependencies for depends list)</span>
</span></span><span style="display:flex;"><span>$ apkg-redundantdeps -f
</span></span></code></pre></div>
  </main>

  </article>
  <footer class="no-print">
    <div class="pull-left">
        <a href="https://gohugo.io">Powered by Hugo.</a>
    </div>
    
    </div>
</footer>

</body>
</html>
